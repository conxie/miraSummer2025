---
title: "R Notebook"
output: html_notebook
---


Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

#Loading Packages

```{r}
#install.packages("tidyverse")
#install.packages("haven")
#install.packages("readr")
#install.packages("readxl")
#install.packages("openxlsx")
library(tidyverse)
library(haven)
library(readr)
library(readxl)
library(openxlsx)
```


#Loading the File in

```{r}
#hint: use read.csv() to load in the file


#additional hint: customfilename = read.csv('filepath')

ASDScreeningData = read.csv("~/GitHub/miraSummer2025/ASDScreeningDataChildren.csv")
```


#view the file
```{r}
#hint: use view() 
view(ASDScreeningData)

```

CX comment: try to combine the two mutates into one single pipe chain. Aka combine lines 55 and 58
#Q1: Correlation between age and ASD diagnosis. 4-11 year olds
```{r}
#Data manipulation

#make it so that Class.ASD in the dataframe is not binary ("YES/NO"), but numeric (1/0). There are many ways which this can be done. ifelse() is one way. 


#try to find more ways on how to convert binary to numeric

ASDScreeningData = ASDScreeningData %>%
  mutate(Class.ASD = ifelse(Class.ASD == "YES", 1, 0))

ASDScreeningData = ASDScreeningData %>%
  mutate(austim = ifelse(austim == "yes", 1, 0))



# Fit the logistic regression model 
#my_model = glm(outcome ~ predictor1 + predictor2, family = binomial, data = customfilename)
my_model = glm(austim ~ age, family = binomial, data = ASDScreeningData)

# View the model summary 
summary(my_model)


```

*Interpret Model Summary:*
For every 1 unit change in age, the log odds of an ASD diagnosis decrease by 0.02848, with a standard error of 0.06753. However, the p-value for age is 0.67318, which is higher than the general alpha value of 0.05. At the 5% significance level, there is insufficient evidence to reject the null hypothesis. If the null hypothesis is true, my observed sample, or results more extreme than it, occurred by chance 67.318% of the time. In summary, there is not sufficient evidence of a correlation between age and ASD diagnosis.


#Make Graph for Q1
```{r}
#Make a graph.
#https://psyc193l.github.io/index.html <-- Ch 7 will help you figure out  


#make a bar chart that looks at count 

countASD = ASDScreeningData %>%
  group_by(age) %>%
  count(Class.ASD) %>%
  filter(Class.ASD == 1)

countASD %>%
  ggplot(aes(x = age, y = n)) +
  stat_summary(geom = "bar", 
               fun = mean, 
               fill = "#4169E1", 
               color = "black") +
  stat_summary(geom = "errorbar", 
               fun.data = mean_se, 
               width = 0.2, 
               color = "black") +
  labs(
    title = "Count of Autism Diagnoses by Age",
    x = "Age",
    y = "Autism Count"
  ) +
  theme_minimal() + 
  theme(plot.title = element_text(size = 12, 
                                  hjust = 0.5, 
                                  face = "bold"),
        axis.title = element_text(size = 10,
                                  face = "bold",
                                  color = "darkgray")) 

#see if any other graphs would be a good fit to represent the data
#Jitter Plot

ASDScreeningData %>%
  ggplot(aes(x = age, y = Class.ASD, color = factor(Class.ASD))) +
  geom_jitter(width = 0.4, height = 0.5, size = 2, alpha = 0.7) +
  scale_color_manual(values = c("0" = "#FFA07A", "1" = "#20B2AA"), 
                     labels = c("No ASD", "ASD")) +
  scale_y_continuous(breaks = c(0, 1), labels = c("No ASD", "ASD")) +
  labs(
    title = "Distribution of Autism Diagnoses by Age",
    x = "Age",
    y = "Autism Diagnosis",
    color = "Diagnosis"
  ) 
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    legend.position = "top")

#use ...count... to show proportion (found in 193L textbook)
```




#Q2: Correlation between Jaundice diagnosis and ASD diagnosis. 4-11 year olds
```{r}
# Try your best! This one is less handholdy

#chi square test 
#https://www.datacamp.com/tutorial/chi-square-test-r

# Install and load the package
#install.packages('dplyr')

#library(dplyr)


# Select the columns of interest
selected_data <- ASDScreeningData %>% select(age, Class.ASD)

# Create a contingency table for Highest educational level and Anemia level
contingency_table <- table(selected_data$age, selected_data$Class.ASD)

# View the contingency table
print(contingency_table)

# Perform chi-square test
chi_square_test <- chisq.test(contingency_table)

# View the results
print(chi_square_test)

```

*Interpret Model Summary:*
The chi-square test statistic is 4.7117, which measures how far the observed counts are from the expected counts, relative to the expected counts. Because the chi-square value is on the smaller side, it suggests stronger evidence for the null hypothesis. Additionally, the p-value of 0.6951 is less than the general alpha value of 0.05. In conclusion, at the 5% significance level, there is insufficient evidence to reject the null hypothesis. There is not enough evidence to suggest that there is a correlation between a jaundice diagnosis and an ASD diagnosis for children screened in this sample. 


#Make Graph for Q2
```{r}
#Make a graph.
#https://psyc193l.github.io/index.html <-- Ch 7 will help you figure out  

countASD = ASDScreeningData %>%
  group_by(jundice) %>%
  count(Class.ASD) %>%
  filter(Class.ASD == 1)

countASD %>%
  ggplot(aes(x = jundice , y = n,
             fill = jundice)) +
  stat_summary(geom = "bar", 
               fun = mean, 
               color = "black") +
  stat_summary(geom = "errorbar", 
               fun.data = mean_se, 
               width = 0.2, 
               color = "black") + 
  scale_fill_manual(values = c("no" = "#FA003F",
                                "yes" = "#00A86B")) + 
  labs(
    title = "Count of Autism Diagnoses by Jaundice Diagnoses",
    x = "Jaundice",
    y = "Autism Count"
  ) +
  theme_minimal() + 
  theme(plot.title = element_text(size = 12, 
                                  hjust = 0.5, 
                                  face = "bold"),
        axis.title = element_text(size = 10,
                                  face = "bold",
                                  color = "darkgray")) + 
  theme(legend.position = "none")
  

ASDScreeningData %>%
  ggplot(aes(y = Class.ASD, x = jundice,
             color = jundice)) +
  geom_jitter() +
  scale_color_manual(values = c("no" = "#FA003F",
                                "yes" = "#00A86B")) +
  stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.2) +
   stat_summary(fun = "mean", geom = "point", color = "black") +
  labs(
    title = "Count of Autism Diagnoses by Jaundice Diagnoses",
    x = "Jaundice",
    y = "Autism Count",
  ) +
  theme_minimal() + 
  theme(plot.title = element_text(size = 12, 
                                  hjust = 0.5, 
                                  face = "bold"),
        axis.title = element_text(size = 10,
                                  face = "bold",
                                  color = "darkgray")) + 
  theme(legend.position = "none")


```

