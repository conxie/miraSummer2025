---
title: ""
author: ""
date: ""
output: html_document
---

```{r}
library(tidyverse)
# Modify the file path in the code below to properly load the "NFLScores2021.RData" file
load("~/Desktop/GitHub/R Bootcamp/Basic Data Wrangling - 3/Wrangling and Summarizing Challenge/NFLScores2021.RData")
```

You realized after playing around a bit with your football analytics hat that maybe being a pokemon researcher was not the most lucrative opportunity for you to be implementing your R skills... After impressing with all your work so far, you were able to land a job doing some real NFL analytics! You have been given the data from the entire 2021 NFL season in the `NFL` df. 

`NFL` contains the following variables:

* `game_id` - an arbitrary ID for the game
* `week` - what week of the season the game was played
* `day` - what day of the week the game was played
* `home_team` - who the home team was
* `away_team` - who the away team was
* `home_score` - the score of the home team
* `away_score` - the score of the away team
* `season_type` - whether this was the regular season or playoffs
* `roof` - what type of stadium the game was played in
* `surface` - the surface type the stadium had
* `start_time` - what time the game started
* `div_game` - whether this was a game with two teams from the same division

Your job is to use this data to try and learn all you can to give your new team the edge in the upcoming season, and have been given a stack of tasks to complete to help with this. For each question, you must find the answers numerically AND create a graph to visualize it.

*NOTE:* 
> You may sometimes have to compute new variables or modify existing ones to answer these questions!
> There may be more than one way to answer a question. Part of this exercise is thinking about what kind of evidence you can look for with the data you have, and what would help make a compelling answer.

### Part 1:

1. Does the playing surface impact points scored by the away team?

  A. What are some reasons why this might be true?

    - Away team has a different home playing surface
    - Away team is not used to the rival home team's playing surface
    - Home team does better on their home's playing surface
  
  B. What are some reasons this might not be true?

    - Both teams could have the same playing surface in their own respective arenas
    - Individual skills of players might be independent of the surface they play on

  C. What is your prediction?

    - I think there could be some effect on away team's point score depending on the playing surface.
    
  D. Investigate

  
```{r}
NFL %>%
  mutate(surface = factor(surface) %>%
           fct_infreq()) %>%
  ggplot(aes(y = away_score, x = surface)) +
  geom_bin2d() + 
  scale_fill_distiller(palette = "GnBu")

```
  
  E. Summarize

    From the graph, it appears that the grass surface type is the surface that most away teams play on, and it is also the surface type where they score highly, as shown by the higher concentration of green bars in that section. In contrast, surfaces like matrixturf and sportturf have a lower number of away teams playing on them and also have a lower overall score for those teams as seen by the higher concentration of dark blue bars in that section.
    
  F. Overall conclusion and rationale

    It cannot fully be concluded that one surface type is better than another for away team scoring from this graph, as there is a clear imbalance in the number of teams playing on each type of surface. If each bar on the graph was the same color, that would indicate there was an even sample size for each surface type, which may display a possible association between surface type and away score. Since the bars are all different colors and heights, that indicates that score is changing per surface type, but that could be because there are differing numbers of teams playing on each surface, or some other reason besides the type of surface.


2. Is there a home field advantage?

  A. What are some reasons why there might be?

    Home teams are more confident playing in their own stadiums and on their own turf (e.g. more fans, familiarity with layout, etc.).
  
  B. What are some reasons why there might not be?

    Individual players' skill levels could be their advantage, not where they are playing.

  C. What is your prediction?

    I predict that there is no home team advantage.
    
  D. Investigate

  
```{r}
H1 <- NFL %>%
   mutate(surface = factor(surface) %>%
           fct_infreq()) %>%
  ggplot(aes(y = home_score, x = surface)) +
  geom_bin2d() + 
  scale_fill_distiller(palette = "GnBu") + 
  labs(title = "Is there a Home Team Advantage?", 
       y = "Home Score",
       x = "Surface Type", 
       tag = "H1")

A1 <- NFL %>%
   mutate(surface = factor(surface) %>%
           fct_infreq()) %>%
  ggplot(aes(y = away_score, x = surface)) +
  geom_bin2d() + 
  scale_fill_distiller(palette = "GnBu") + 
  labs(title = "Is there a Home Team Advantage?", 
       y = "Home Score",
       x = "Surface Type", 
       tag = "A1")


H2 <- NFL %>%
   mutate(roof = factor(roof) %>%
           fct_infreq()) %>%
  ggplot(aes(y = home_score, x = roof)) +
  geom_bin2d() + 
  scale_fill_distiller(palette = "GnBu") + 
  labs(title = "Is there a Home Team Advantage?", 
       y = "Home Score",
       x = "Roof Type", 
       tag = "H2")

A2 <- NFL %>%
   mutate(roof = factor(roof) %>%
           fct_infreq()) %>%
  ggplot(aes(y = away_score, x = roof)) +
  geom_bin2d() + 
  scale_fill_distiller(palette = "GnBu") + 
  labs(title = "Is there a Home Team Advantage?", 
       y = "Home Score",
       x = "Roof Type", 
       tag = "A2")

(H1 | A1) / (H2 | A2)
```
  
  E. Summarize

    Both team types' score graphs show most teams played on grass outdoors, with about the same scores for this setting, as shown by the high concentration of green bars in the grass and outdoors sections of all four graphs. The same goes for the other surface and roof types; the distribution of scores and number of teams playing on them seems roughly the same.
    
  F. Overall conclusion and rationale

    There does not appear to be a substantial home score advantage as demonstrated by this sample of data, as the scores for both the home teams and away teams look roughly the same across surface types and roof types in all four graphs. If there was a home team advantage, we would most likely see higher concentrations of green (more home teams) in the upper scores of the home team graphs as compared to the away team graphs.

3. How does the number of points scored per game compare from the first half of the **REGULAR SEASON** to the second half of the **REGULAR SEASON**?

  A. What is your prediction?

    I think the first half of the regular season shows higher points scored per game compared to the second half of the regular season.
  
  B. What are some reasons why this might be true?

    The season's first half might be where teams have the most energy, and therefore score more points.

  C. What are some reasons this might not be true?

    The teams could get more serious about winning as they proceed in the season and the scores might not change, or they may even go up.
    
  D. Investigate

  
```{r}
NFL %>%
  mutate("total_points" = home_score + away_score) %>%
  relocate("total_points", .after = "away_score") %>%
  select(c(total_points, season_type)) %>%
  filter(season_type == "REG") %>%
  print(n = 272)

```
  
  E. Summarize

    The data demonstrates a consistent fluctuation in total points scored across the entire regular season, with no strong positive or negative trendline.

  F. Conclusion
  
    The number of points scored per game across both halves of the regular season is roughly the same throughout.
    
  G. Now, instead of comparing the first half of the **REGULAR SEASON** to the second half, compare across the entire **REGULAR SEASON** week by week.

  
```{r}
NFL %>%
  mutate("total_points" = home_score + away_score) %>%
  relocate("total_points", .after = "away_score") %>%
  select(c(total_points, season_type, week)) %>%
  filter(season_type == "REG") %>%
  arrange(week) %>%
  ggplot(aes(y = total_points, x = week)) + 
  geom_jitter()

```

  H. Is the pattern/relationship consistent with the one above? If not, in what way is it different?

    The pattern displayed by this arrangement of data is pretty similar to the one above. The total points scored per week vary, but generally exhibit a consistent variation across the weeks with the occasional outlying score.
    
  I. Overall conclusion and rationale

    There is a consistent fluctuation in scores across the regular season. If there was an increase in scores across the season, the total points scored would increase per week, and if there was a decrease, the opposite.


4. Does the average difference between the winning score and the losing score (the score differential) increase or decrease as you get farther into the season? 
  (*hint:* you may find the `abs()` function useful here)

  A. What are some reasons why this might be true?

    This could be true if teams start performing dramatically better or worse as they progress through the season (e.g. energy levels, practice time, skill levels).
  
  B. What are some reasons this might not be true?

    Teams could perform consistently across the season with no big increase or decrease in the score differentials.

  C. What is your prediction?

    I think there could be a significant increase/decrease in the score differentials across the season.
    
  D. Investigate

  
```{r}
NFL %>%
  mutate("score_differential" = home_score - away_score) %>%
  select(c(week, season_type, score_differential)) %>%
  print(n = 285)

```
  
  E. Summarize

    The score differential doesn't seem to increase or decrease dramatically over the course of the season. There are both wide gaps between the winning and losing scores and small gaps between the winning and losing scores across the season.
    
  F. Now, use an alternative type of visualization to investigate

  
```{r}
NFL %>%
  mutate("score_differential" = home_score - away_score) %>%
  select(c(week, season_type, score_differential)) %>%
  ggplot(aes(y = score_differential, x = week)) + 
  geom_bin2d() + 
  scale_fill_viridis(option = "plasma")
```

  G. Is the pattern/relationship the same as above? If not, in what way is it different?

    The pattern displayed by this graph appears to be similar across the weeks of the season as seen above. There are a few large differentials, but across the season, the differentials are relatively constant as a whole.
    
  H. Overall conclusion and rationale

    There is not a large increase or decrease in the scores of the winning vs. losing teams across the season.

5. Come up with your own question you are interested in exploring with this data.

  A. What is the question?

    Does an earlier start time result in a home team win?

  B. What is your prediction?

    No, the time of a game does not result in a home team win.
  
  C. What are some reasons why this might be true?

    Home teams are more comfortable on their turf and can start practicing earlier than away teams.

  D. What are some reasons this might not be true?

    The time of a game doesn't influence the skill levels of either team, so the time of a game shouldn't make a difference on who wins.
    
  E. Investigate

  
```{r}
HOME <- NFL %>%
  select(c(home_score, away_score, start_time)) %>%
  arrange(desc(start_time)) %>%
  ggplot(aes(y = home_score, x = start_time)) + 
  geom_bin_2d() + 
  scale_fill_distiller(palette = "RdBu")

AWAY <- NFL %>%
  select(c(home_score, away_score, start_time)) %>%
  arrange(desc(start_time)) %>%
  ggplot(aes(y = away_score, x = start_time)) + 
  geom_bin_2d() + 
  scale_fill_distiller(palette = "RdBu")

HOME | AWAY
  
```
  
  F. Summarize

    From these visualizations, the scores for both teams at each start time are relatively similar, with a few outliers. This pattern may not be due to start time since the pattern and spread of the data is similar in both graphs. If an earlier start time did result in a home team win, there would be significantly more red bars in the higher parts of the home team graph at earlier start times compared to the away team graph at those times.
    
  G. Overall conclusion and rationale

    An earlier start time does not guarantee a home team win.

6. Come up with another question you are interested in exploring with this data.

  A. What is the question?

    Is the average total score of games played in the regular season higher than the average total score of games played in the playoff season?

  B. What is your prediction?

    I predict that the average total score of games played in the playoff season is higher than the average total score of games played in the regular season.
  
  C. What are some reasons why this might be true?

    Playoff season is more crucial to players, as it determines who is the best of the best.

  D. What are some reasons this might not be true?

    Regular season could be a time to win dramatically with more teams to play against, some of whom may be much worse and therefore easier to beat than others.
    
  E. Investigate

  
```{r}
NFL %>%
  mutate("total_points" = home_score + away_score) %>%
  relocate("total_points", .after = "away_score") %>%
  filter(season_type == "REG") %>%
  pull(total_points) %>%
  mean()

NFL %>%
  mutate("total_points" = home_score + away_score) %>%
  relocate("total_points", .after = "away_score") %>%
  filter(season_type == "POST") %>%
  pull(total_points) %>%
  mean()
```
  
  F. Summarize

    The average total points scored in the playoff season is higher than the average total points scored in the regular season.
    
  G. Overall conclusion and rationale

    The average total points scored in the playoff season is higher than the average total points scored in the regular season, which could be due to many factors such as higher stakes, more energy, increased morale, more practice during the regular season, etc.
    
### Part 2:

Answer the following without using visualizations:

1. How many games did each team win?

```{r}
team_wins <- NFL %>%
    mutate(winner = ifelse(home_score > away_score, home_team, away_team)) %>%
    group_by(winner) %>%
    summarise(wins = n())
print(team_wins)
```

2. Did home or away teams win more?

```{r}

NFL$Winner <- ifelse(NFL$home_score > NFL$away_score, "Home",
                     ifelse(NFL$away_score > NFL$home_score, "Away", "Draw"))

win_counts <- table(NFL$Winner)
print(win_counts)

win_summary <- NFL %>%
  group_by(Winner) %>%
  summarize(Count = n())

print(win_summary)

if (win_counts["Home"] > win_counts["Away"]) {print("Home teams won more games.")} else if (win_counts["Away"] > win_counts["Home"]) {print("Away teams won more games.")} else {print("Home and away teams won the same number of games (or there are more draws).")}

```

    - Home teams won more games.

3. Which team scored the most points on average at home? Away?

```{r}
NFL %>%
  select(c(home_team, home_score)) %>%
  group_by(home_team) %>%
  summarise(average_home_points = mean(home_score)) %>%
  arrange(desc(average_home_points))

NFL %>%
  select(c(away_team, away_score)) %>%
  group_by(away_team) %>%
  summarise(average_away_points = mean(away_score)) %>%
  arrange(desc(average_away_points))
```

    - The DAL scored the most points on average at home, and the BUF scored the most points on average away.

4. Which team had the highest average *winning* point differential (the difference between the winning score and the losing score)?

```{r}
NFL %>%
  mutate("win_diff" = home_score - away_score) %>%
  relocate("win_diff", .after = "away_score") %>%
  group_by(home_team) %>%
  summarize(avg_winning_point_differential = mean(win_diff)) %>%
  arrange(desc(avg_winning_point_differential))
```

    - TB had the highest average winning point differential.

5. Did the day the game was played impact the total points scored?

```{r}
NFL %>%
  mutate("total_points" = home_score + away_score) %>%
  relocate("total_points", .after = "away_score") %>%
  select(c(day, total_points)) %>%
  group_by(day) %>%
  summarize(avg_points_per_day = mean(total_points)) %>%
  arrange(day)
```

    - The day the game was played could have impacted the total points scored, since the avg. points per day throughout the season shows fluctuations in score. But day may not be the only variable contributing to this fluctuation, since there are many variables that factor into the total points scored in any game.



# Feedback

Please save the appropriate number to the variables below:

1. Approximately how long (in minutes) do you think it took you to complete this assignment?

```{r}
timeEstimate = 60
```

2. How difficult or challenging did you find this assignment?

Extremely easy -------------------------------------- Extremely challenging 
                                                     (impossible to complete)
    1                                                           10
    
```{r}
challenge = 
```
    
    
3. How engaging or fun did you find this assignment?
  
Extremely Boring and Dry -------------------------------------- Extremely Engaging and Fun 
          1                                                                   10

```{r}
engagement = 
```

4. If you have any other feedback about this assignment, please provide it below.






